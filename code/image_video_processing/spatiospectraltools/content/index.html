<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>ISP - Image and Signal Processing group</title>
<link href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin=anonymous referrerpolicy=no-referrer><link rel="shortcut icon" href=/github/images/favicon.ico type=image/x-icon><link rel=stylesheet href=/github/style/style.css><script src=/github/js/mode.js></script><script src=https://cdn.jsdelivr.net/npm/marked/marked.min.js></script></head><nav class=custom-navbars><div class=custom-container><a href=/ class="custom-logo custom-hide-on-large"><img src=/github/images/isp_logo_sinfondo.webp alt="ISP Icon" class=custom-logo_nav>
<span class=custom-text-isp>ISP</span>
</a><button class=navbar-toggler aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class=custom-navbar-collapse><ul class=custom-navbar-nav><li class="custom-nav-item custom-desktop-only"><a class=custom-nav-link href=/github/>ISP</a></li><li class=custom-nav-item><a class=custom-nav-link href=/github/people/>People</a></li><li class="custom-nav-item custom-dropdown"><a class="custom-nav-link custom-dropdown-toggle" href=/github/research/philosophy>Research</a><ul class=custom-dropdown-menu><li><a class=custom-dropdown-item href=/github/research/machine_learning/>Machine learning</a></li><li><a class=custom-dropdown-item href=/github/research/visual_neuroscience/>Visual neuroscience</a></li><li><a class=custom-dropdown-item href=/github/research/visual_brain/>Visual brain</a></li><li><a class=custom-dropdown-item href=/github/research/earth_science/>Earth science</a></li><li><a class=custom-dropdown-item href=/github/research/social_science>Social science</a></li></ul></li><li class=custom-nav-item><a class=custom-nav-link href=/github/projects/>Projects</a></li><li class=custom-nav-item><a class=custom-nav-link href=/github/facilities/>Facilities</a></li><li class="custom-nav-item custom-dropdown"><a class="custom-nav-link custom-dropdown-toggle" href=/github/publications/journals/>Publications</a><ul class=custom-dropdown-menu><li><a class=custom-dropdown-item href=/github/publications/journals/>Journals</a></li><li><a class=custom-dropdown-item href=/github/publications/conferences/>Conferences</a></li><li><a class=custom-dropdown-item href=/github/publications/books/>Books</a></li><li><a class=custom-dropdown-item href=/github/publications/talks/>Talks</a></li><li><a class=custom-dropdown-item href=/github/publications/technical_reports/>Technical Reports</a></li><li><a class=custom-dropdown-item href=/github/publications/theses/>Theses</a></li></ul></li><li class=custom-nav-item><a class=custom-nav-link href=/github/code/>Code</a></li><li class=custom-nav-item><a class=custom-nav-link href=/github/data/>Data</a></li><li class=custom-nav-item><a class=custom-nav-link href=/github/seminars/>Seminars</a></li><li class=custom-nav-item><a class=custom-nav-link href=/github/courses/>Courses</a></li><li class=custom-nav-item><a class=custom-nav-link href=/github/collaborators/>Collaborators</a></li><li class=custom-nav-item><a class=custom-nav-link href=/github/news/>News</a></li><li class=custom-nav-item><a class=custom-nav-link href=/github/contact/>Contact</a></li></ul></div></div></nav><style>.custom-navbars{background-color:#222;position:fixed;top:0;width:100%;display:flex;align-items:center;justify-content:space-between;padding:0 1rem;z-index:1000;height:3rem}.custom-container{display:flex;width:100%;height:100%;justify-content:center;align-items:center}.custom-logo{display:flex;align-items:center}.custom-logo_nav{height:30px}.custom-hide-on-large{display:none}.navbar-toggler{display:none}.navbar-toggler-icon{background-image:url("data:image/svg+xml,%3csvg viewBox='0 0 30 30' xmlns='http://www.w3.org/2000/svg'%3e%3cpath stroke='white' stroke-width='2' stroke-linecap='round' stroke-miterlimit='10' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e")}.custom-navbar-collapse{flex-grow:.95;height:100%;align-content:center}.custom-navbar-nav{list-style:none;display:flex;flex-direction:row;padding:0;margin:0;height:100%}.custom-nav-item{flex:auto;text-align:center;border:2px solid transparent;border-radius:8px;height:100%;display:flex;align-items:center;justify-content:center}.custom-nav-item:hover{background-color:#a0a0a0;border-color:#fff}.custom-nav-link{text-decoration:none;color:#f8f8f8;font-size:clamp(1rem,1.1vw,1.1rem);position:relative;display:block}.custom-dropdown-menu{position:absolute;background-color:rgba(46,46,46,.9);text-decoration:none;display:none;list-style:none;padding:.5rem 0;margin:0;border-radius:5px;font-size:clamp(1rem,1.1vw,1.1rem);top:3rem}.custom-dropdown-toggle::after{content:"â–¼";font-size:.5rem;margin-left:.3rem;color:#f8f8f8;display:inline-block;vertical-align:middle}.custom-dropdown-item{padding:0 1rem;color:#f8f8f8;text-decoration:none;margin:0;display:block;border:2px solid transparent;border-radius:8px}.custom-dropdown-item:hover{background-color:#a0a0a0;border-color:#fff}.custom-dropdown:hover .custom-dropdown-menu{display:block}.custom-nav-item.active{background-color:#464646}.custom-dropdown-item.active{background-color:#535353}@media(max-width:1070px){.custom-container{display:flex;width:100%;justify-content:space-between}.navbar-toggler{display:block;position:absolute;right:1rem;top:.5rem}.custom-hide-on-large{display:flex;align-items:center;text-decoration:none}.custom-navbar-collapse{display:none;flex-direction:column;width:100%;background-color:rgba(46,46,46,.9);position:absolute;top:3rem;left:0;z-index:999;height:auto;overflow:hidden;max-height:0;transition:max-height .3s ease-out;padding:.5rem 0;border-bottom-left-radius:.5rem;border-bottom-right-radius:.5rem}.custom-navbar-collapse.show{display:flex;max-height:100vh;overflow-y:auto}.custom-navbar-nav{flex-direction:column;align-items:center;width:100%}.custom-nav-item{width:100%;margin:0;display:block}.custom-nav-item a{text-align:left;margin-left:10%}.custom-text-isp{margin-left:.5rem;font-size:1rem;text-decoration:none;color:#f8f8f8}.custom-nav-link{width:100%;text-align:center}.custom-dropdown-menu{position:static;display:none;width:100%;background-color:#333}.custom-dropdown:hover .custom-dropdown-menu,.custom-dropdown .custom-dropdown-menu.show{display:block}}</style><script>document.addEventListener("DOMContentLoaded",function(){const n=document.querySelector(".navbar-toggler"),t=document.querySelector(".custom-navbar-collapse"),e=window.location.pathname;n.addEventListener("click",function(){t.classList.toggle("show")}),document.addEventListener("click",function(e){e.target.closest(".custom-navbars")||t.classList.remove("show")});const s=document.querySelectorAll(".custom-nav-link");s.forEach(t=>{const n=new URL(t.href).pathname;n===e&&e!=="/"&&t.closest(".custom-nav-item").classList.add("active")});const o=document.querySelectorAll(".custom-dropdown-item");o.forEach(t=>{const n=new URL(t.href).pathname;if(n===e){t.classList.add("active");const e=t.closest(".custom-dropdown");e&&e.classList.add("active")}});const i=document.querySelectorAll(".custom-dropdown");i.forEach(t=>{const n=t.querySelectorAll(".custom-dropdown-item");n.forEach(n=>{const s=new URL(n.href).pathname;s===e&&t.classList.add("active")})})})</script><main><div class=container><div class="content-container grid-layout"><div class=box-header><h1>The role of spatial information in disentangling the irradiance-reflectance-transmitance ambiguity</h1></div><div class=box-abstract><p><p>In the satellite hyperspectral measures the contributions of light, surface, and atmosphere are mixed. Applications need separate access to the sources. Conventional inversion techniques usually take a pixel-wise, spectral-only approach. However, recent improvements in retrieving surface and atmosphere characteristics use heuristic spatial smoothness constraints.</p><p>In this paper we theoretically justify such heuristics by analyzing the impact of spatial information on the uncertainty of the solution. The proposed analysis allows to assess in advance the uniqueness (or robustness) of the solution depending on the curvature of a likelihood surface. In situations where pixel-based approaches become unreliable it turns out that the consideration of spatial information always makes the problem to be better conditioned. With the proposed analysis this is easily understood since the curvature is consistent with the complexity of the sources measured in terms of the number of significant eigenvalues (or free parameters in the problem). In agreement with recent results in hyperspectral image coding, spatial correlations in the sources imply that the intrinsic complexity of the spatio-spectral representation of the signal is always lower than its spectral-only counterpart. According to this, the number of free parameters in the spatio-spectral inverse problem is smaller so the spatio-spectral approaches are always better than spectral-only approaches.</p><p>Experiments using ensembles of actual reflectance values and realistic MODTRAN irradiance and atmosphere radiance and transmittance values show that the proposed analysis successfully predicts the practical difficulty of the problem and the improved quality of spatio-spectral retrieval.</p><h2 id=supplementary-material>Supplementary Material</h2><ol><li>Extends the results in the manuscript to different spatial structures.</li><li>Extends the results in the manuscript to different wavelength ranges and spatio-spectral resolutions.</li><li>Statistically justifies the initialization scheme of sources.</li><li>Provides sample data and code.</li></ol><p>The generality of the conclusion is not surprising since the imaging equation and the PCA decompositions do not depend on the specific spatio-spectral resolution or wavelength range. The joint spatio-spectral approach will simplify the problem whenever there are relations between the signal at different spatial positions, which is true in a wide range of situations given the spatial continuity of the physical sources (the reflecting objects and the atmospheric phenomena).</p><h2 id=1-effect-of-the-spatial-structure>1. Effect of the Spatial Structure</h2><p>Original and estimated reflectance images for sites of different spatial complexity (urban, forest, and open fields) using spectral-only and spatio-spectral retrieval. In these cases, the spatial resolution and wavelength range were the same as in the manuscript. No additional training was necessary, only the application of the previous analysis on new test locations.</p><h2 id=2-effect-of-wavelength-range-and-spatio-spectral-resolution>2. Effect of Wavelength Range and Spatio-Spectral Resolution</h2><p>In this experiment, we used substantially different wavelength ranges and spatio-spectral resolutions from those in the manuscript.</p><h2 id=3-initialization-of-the-sources-surface-reflectance-atmosphere-radiance-and-transmittance>3. Initialization of the Sources (Surface Reflectance, Atmosphere Radiance, and Transmittance)</h2><p>The retrieval procedure used to check the accuracy of the theoretical predictions involves a series of search loops that require an initialization of the variables S, A, and T. Since we searched in the decorrelated PCA domains, each coefficient of these sources was independently initialized using a random value drawn from the empirical marginal PDFs (histograms) learned at the training stage. Below we show examples of the marginal PDFs for some AC coefficients of these sources. The strong peak at zero makes zero initialization reasonable as well.</p></p></div><aside class=box-gallery><div class=gallery-grid><div class=gallery-item><a href=javascript:void(0); class=gallery-thumbnail onclick='openModal("/github/images/code/org_contex.webp","[Original and Estimated Reflectance - Urban Context](#1-effect-of-the-spatial-structure)","Reflectance images for urban, forest, and open field sites using spectral-only and spatio-spectral retrieval approaches.")'><img src=/github/images/code/org_contex.webp alt="[Original and Estimated Reflectance - Urban Context](#1-effect-of-the-spatial-structure)"></a><p class=gallery-title><a href=#1-effect-of-the-spatial-structure>Original and Estimated Reflectance - Urban Context</a></p><div class=gallery-description><p>Reflectance images for urban, forest, and open field sites using spectral-only and spatio-spectral retrieval approaches.</p></div></div><div class=gallery-item><a href=javascript:void(0); class=gallery-thumbnail onclick='openModal("/github/images/code/reco_contex.webp","[Reconstructed Reflectance for Different Contexts](#1-effect-of-the-spatial-structure)","Reconstructed reflectance images from different contexts, highlighting the difference between spectral-only and spatio-spectral retrieval.")'><img src=/github/images/code/reco_contex.webp alt="[Reconstructed Reflectance for Different Contexts](#1-effect-of-the-spatial-structure)"></a><p class=gallery-title><a href=#1-effect-of-the-spatial-structure>Reconstructed Reflectance for Different Contexts</a></p><div class=gallery-description><p>Reconstructed reflectance images from different contexts, highlighting the difference between spectral-only and spatio-spectral retrieval.</p></div></div><div class=gallery-item><a href=javascript:void(0); class=gallery-thumbnail onclick='openModal("/github/images/code/errores.webp","[Error Maps for Reflectance Estimation](#2-effect-of-wavelength-range-and-spatio-spectral-resolution)","Error maps showing the differences in reflectance estimation using spectral-only and spatio-spectral methods.")'><img src=/github/images/code/errores.webp alt="[Error Maps for Reflectance Estimation](#2-effect-of-wavelength-range-and-spatio-spectral-resolution)"></a><p class=gallery-title><a href=#2-effect-of-wavelength-range-and-spatio-spectral-resolution>Error Maps for Reflectance Estimation</a></p><div class=gallery-description><p>Error maps showing the differences in reflectance estimation using spectral-only and spatio-spectral methods.</p></div></div><div class=gallery-item><a href=javascript:void(0); class=gallery-thumbnail onclick='openModal("/github/images/code/IR_example.webp","[Infrared Example - Different Wavelengths and Resolutions](#2-effect-of-wavelength-range-and-spatio-spectral-resolution)","Example using different wavelength ranges and spatio-spectral resolutions in reflectance retrieval.")'><img src=/github/images/code/IR_example.webp alt="[Infrared Example - Different Wavelengths and Resolutions](#2-effect-of-wavelength-range-and-spatio-spectral-resolution)"></a><p class=gallery-title><a href=#2-effect-of-wavelength-range-and-spatio-spectral-resolution>Infrared Example - Different Wavelengths and Resolutions</a></p><div class=gallery-description><p>Example using different wavelength ranges and spatio-spectral resolutions in reflectance retrieval.</p></div></div><div class=gallery-item><a href=javascript:void(0); class=gallery-thumbnail onclick='openModal("/github/images/code/marginales_S.webp","[Marginal Distributions for Surface Reflectance](#3-initialization-of-the-sources-surface-reflectance-atmosphere-radiance-and-transmittance)","Marginal PDFs for surface reflectance coefficients in the PCA domain.")'><img src=/github/images/code/marginales_S.webp alt="[Marginal Distributions for Surface Reflectance](#3-initialization-of-the-sources-surface-reflectance-atmosphere-radiance-and-transmittance)"></a><p class=gallery-title><a href=#3-initialization-of-the-sources-surface-reflectance-atmosphere-radiance-and-transmittance>Marginal Distributions for Surface Reflectance</a></p><div class=gallery-description><p>Marginal PDFs for surface reflectance coefficients in the PCA domain.</p></div></div><div class=gallery-item><a href=javascript:void(0); class=gallery-thumbnail onclick='openModal("/github/images/code/marginales_A.webp","[Marginal Distributions for Atmosphere Radiance](#3-initialization-of-the-sources-surface-reflectance-atmosphere-radiance-and-transmittance)","Marginal PDFs for atmospheric radiance coefficients in the PCA domain.")'><img src=/github/images/code/marginales_A.webp alt="[Marginal Distributions for Atmosphere Radiance](#3-initialization-of-the-sources-surface-reflectance-atmosphere-radiance-and-transmittance)"></a><p class=gallery-title><a href=#3-initialization-of-the-sources-surface-reflectance-atmosphere-radiance-and-transmittance>Marginal Distributions for Atmosphere Radiance</a></p><div class=gallery-description><p>Marginal PDFs for atmospheric radiance coefficients in the PCA domain.</p></div></div><div class=gallery-item><a href=javascript:void(0); class=gallery-thumbnail onclick='openModal("/github/images/code/marginales_T.webp","[Marginal Distributions for Atmosphere Transmittance](#3-initialization-of-the-sources-surface-reflectance-atmosphere-radiance-and-transmittance)","Marginal PDFs for atmospheric transmittance coefficients in the PCA domain.")'><img src=/github/images/code/marginales_T.webp alt="[Marginal Distributions for Atmosphere Transmittance](#3-initialization-of-the-sources-surface-reflectance-atmosphere-radiance-and-transmittance)"></a><p class=gallery-title><a href=#3-initialization-of-the-sources-surface-reflectance-atmosphere-radiance-and-transmittance>Marginal Distributions for Atmosphere Transmittance</a></p><div class=gallery-description><p>Marginal PDFs for atmospheric transmittance coefficients in the PCA domain.</p></div></div><div id=imageModal class=modal><span class=modal-close onclick=closeModal()>&#215;</span>
<img class=modal-content id=modalImage><div id=modalCaption class=modal-caption></div></div></div></aside><section class="box-references title2"><h2>References</h2><ul class=references-list><li><strong><a href=https://huggingface.co/datasets/isp-uv-es/Web_site_legacy/resolve/main/code/soft_imvideo/spatiospectral/manuscr_TGRS_2012_00431.pdf target=_blank class=references-name>The role of spatial information in disentangling the irradiance-reflectance-transmitance ambiguity</a></strong><br><span>Sandra JimÃ©nez and JesÃºs Malo</span><br><em>Accepted to IEEE Trans. Geosci. Rem. Sens.</em></li></ul></section><section class="box-enlaces title2"><h2>Download</h2><ul class=enlaces-list><li><a href=https://huggingface.co/datasets/isp-uv-es/Web_site_legacy/resolve/main/code/soft_imvideo/spatiospectral/code_retrieval_and_data.zip>Download Data and Code</a></li></ul></section></div></div></main></body><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js integrity=sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL crossorigin=anonymous defer></script><script type=text/javascript src=https://cdn.jsdelivr.net/gh/pcooksey/bibtex-js@1.0.0/src/bibtex_js.min.js defer></script></html>